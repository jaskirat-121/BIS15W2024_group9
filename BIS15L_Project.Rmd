---
title: "BIS15L_project"
author: "Jaskirat"
date: "2024-03-06"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Install Library 
```{r}
#install.packages("tidyverse")
#install.packages("janitor")
```


#Load Library
```{r}
library(tidyverse)
library(janitor)
library(paletteer)
library(ggthemes)
```


#Import Data
```{r}
health_data <- read_csv("data/ss.csv")
health_data <- clean_names(health_data)
```
```{r}
colors <- paletteer::palettes_d_names
```

```{r}
my_palette <- paletteer_d("awtools::bpalette")
```

#Effects of occupation on sleep duration
```{r}
health_data %>% 
  group_by(occupation) %>% 
  summarize(average_sleep_duration=mean(sleep_duration)) %>% 
  ggplot(aes(x=occupation, y=average_sleep_duration, fill=occupation))+
  geom_col()+
  scale_fill_manual(values=my_palette)+
  theme_light()+
  coord_flip()+
  labs(title="Average Sleep Duration Ranges For Various Occupations",
       x="Occupation", 
       y="Average Sleep Duration (hrs)", 
       fill="Occupation")
```


```{r}
health_data %>% 
  ggplot(aes(x=occupation, y=sleep_duration, fill=occupation))+
  geom_boxplot()+
  scale_fill_manual(values=my_palette)+
  theme_light()+
  labs(title="Average Sleep Duration Ranges For Various Occupations",
       x="Occupation", 
       y="Sleep Duration (hrs)", 
       fill="Occupation")+
  theme(axis.text.x=element_text(angle=60,hjust=1))
```
#Count
```{r}
health_data %>% 
  count(occupation, sort=T)
```

# Top 5 occupations in dataset

```{r}
selected_data <- health_data %>% 
  filter(occupation=="Nurse"| occupation=="Doctor"| occupation=="Engineer"| occupation=="Lawyer"| occupation=="Teacher")
selected_data
```

# Sleep duration vs quality of sleep 
```{r}
selected_data %>% 
  ggplot(aes(x=sleep_duration, y=quality_of_sleep, fill=occupation))+
  geom_col()+
  facet_wrap(~occupation)+
  scale_fill_manual(values=my_palette)+
  theme_light()+
  labs(title="Sleep Duration VS Quality of Sleep")
```

# Stress Levels based on occupation 
```{r}
selected_data %>% 
  ggplot(aes(x=stress_level, fill=occupation))+
  geom_bar()+
  facet_wrap(~occupation)+
  scale_fill_manual(values=my_palette)+
  theme_light()+
  labs(title="Stress Levels for Each Occupation")
```

```{r}
bloodp<- selected_data %>% 
  select(occupation, blood_pressure)
```

# Blood pressures of each occupation 
```{r}
selected_data %>% 
  ggplot(aes(x=blood_pressure, fill=occupation))+
  facet_wrap(~occupation)+
  theme(axis.text.x=element_text(angle=60,hjust=1))+
  scale_fill_manual(values=my_palette)+
  theme_light()+
  labs(title="Stress Levels for Each Occupation")
```

